<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Writ & Reckoning Lore Builder</title>
  <style>
    body {
      background: #1a1a1a;
      color: #eee;
      font-family: sans-serif;
      padding: 2em;
      max-width: 900px;
      margin: auto;
    }
    h1, h2, h3 { color: #ffcb05; }
    label { display: block; margin-top: 1em; font-weight: bold; }
    input, textarea {
      width: 100%;
      padding: 0.5em;
      margin-top: 0.25em;
      border: none;
      background: #2a2a2a;
      color: #fff;
    }
    textarea { height: 8em; resize: vertical; }
    .section { margin-top: 2em; }
    button {
      margin-top: 2em;
      padding: 0.75em 1.5em;
      background: #444;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #666;
    }
  </style>
</head>
<body>
  <h1>ðŸŒ€ Writ & Reckoning Lore Builder</h1>

  <div class="section">
    <h2>Step 1: Define Core Concepts</h2>

    <label>Major Power 1 ({{Chaos}})</label>
    <input type="text" id="Chaos" value="Chaos">

    <label>Major Power 2 ({{Sora}})</label>
    <input type="text" id="Sora" value="Sora">

    <label>Major Power 3 ({{Karn}})</label>
    <input type="text" id="Karn" value="Karn">

    <label>Major Power 4 ({{Virel}})</label>
    <input type="text" id="Virel" value="Virel">

    <label>Original Authority ({{Warden}})</label>
    <input type="text" id="Warden" value="The Warden">

    <label>Source of All Possibility ({{Geode}})</label>
    <input type="text" id="Geode" value="The Geode of Possibility">

    <label>Magical Objects ({{Forms}})</label>
    <input type="text" id="Forms" value="Forms">

    <label>Magic Containers ({{Vessels}})</label>
    <input type="text" id="Vessels" value="Vessels">

    <label>Physical Manifestation of Magic ({{Soulrocks}})</label>
    <input type="text" id="Soulrocks" value="Soulrocks">
  </div>

  <div class="section">
    <h2>Step 2: Lore Text</h2>

    <label>Creation Myth</label>
    <textarea id="creationLore">
In the age before variance, one Power ruled above all others: {{Warden}}. They guarded {{Geode}}, a universe-sized star where every possibility was crystallized. {{Chaos}}, the eldest of the {{Forms}}, grew restless and plotted to steal crystal from the source. When she succeeded, reality fractured and birthed new worlds. Thus began the Age of Rebellion.
    </textarea>

    <label>Nature of Power</label>
    <textarea id="magicLore">
Those who wield {{Vessels}} can channel {{Forms}}, physical shards of chaos shaped by belief. These shards grant powers and reshape the world. Over time, the buildup of this power forms {{Soulrocks}}, which grow like barnacles along the wielderâ€™s body â€” a gift from the Higher Powers.
    </textarea>

    <label>Higher Powers & Their Domains</label>
    <textarea id="powersLore">
{{Chaos}} is wild invention. {{Sora}} is organic growth. {{Karn}} is inevitable change. {{Virel}} is dynamic order. Together they rebelled against {{Warden}}, each offering mortals a piece of their power through the shaping of {{Forms}} and forging of {{Vessels}}.
    </textarea>

    <label>Optional: Lesser Powers & Origins</label>
    <textarea id="lesserLore">
Some mortals ascended to become Lesser Powers. A tarot reader granted vision through time. A botanist who cultivates raw elemental surges. A glassworker who split divine light. DMs may create Lesser Powers to reflect alternate card types or theme decks.
    </textarea>
  </div>

  <button onclick="downloadPDF()">ðŸ“„ Export as PDF</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const keys = ["Chaos", "Sora", "Karn", "Virel", "Warden", "Geode", "Forms", "Vessels", "Soulrocks"];

    function applyVariables(text) {
      keys.forEach(key => {
        const value = document.getElementById(key).value;
        const regex = new RegExp(`{{${key}}}`, 'g');
        text = text.replace(regex, value);
      });
      return text;
    }

    async function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const sections = [
        ["Creation Myth", document.getElementById("creationLore").value],
        ["Nature of Power", document.getElementById("magicLore").value],
        ["Higher Powers", document.getElementById("powersLore").value],
        ["Lesser Powers (Optional)", document.getElementById("lesserLore").value]
      ];

      let y = 10;
      doc.setFont("Times", "Normal");

      sections.forEach(([title, text]) => {
        text = applyVariables(text);
        doc.setFontSize(14);
        doc.text(title, 10, y);
        y += 8;

        doc.setFontSize(11);
        const lines = doc.splitTextToSize(text, 180);
        doc.text(lines, 10, y);
        y += lines.length * 6 + 10;

        if (y > 270) {
          doc.addPage();
          y = 10;
        }
      });

      doc.save("custom-lore.pdf");
    }
  </script>
</body>
</html>
